<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samurai Duel - First Cut Style</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: crosshair;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #1a0808;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        #gameCanvas {
            border: 3px solid #8b0000;
            box-shadow: 0 0 30px rgba(139, 0, 0, 0.5);
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }

        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #ff0000;
            font-size: 20px;
            text-shadow: 2px 2px 4px #000;
            pointer-events: none;
        }

        #startScreen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #ff0000;
            font-size: 48px;
            text-shadow: 0 0 20px #ff0000;
        }

        .btn {
            margin-top: 30px;
            padding: 15px 40px;
            font-size: 24px;
            background: #8b0000;
            border: 3px solid #ff0000;
            color: white;
            cursor: pointer;
            pointer-events: all;
            font-family: 'Courier New', monospace;
        }

        .btn:hover {
            background: #ff0000;
        }
    </style>
</head>
<body>
    <div id="startScreen">
        <div>‰æç FIRST CUT</div>
        <button class="btn" onclick="startGame()">BEGIN DUEL</button>
        <div style="font-size: 18px; margin-top: 30px; color: #ffcccc;">
            Move mouse to aim sword<br>
            Click to SLASH<br>
            Right-click to DODGE<br>
            Space to SHOVE
        </div>
    </div>
    <div id="ui"></div>
    <canvas id="gameCanvas" width="1200" height="700"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const ui = document.getElementById('ui');

        let gameStarted = false;
        let gameOver = false;
        let kills = 0;

        // Player character
        const player = {
            x: 300,
            y: 500,
            width: 30,
            height: 80,
            swordAngle: 0,
            swordLength: 80,
            attacking: false,
            attackTimer: 0,
            dodging: false,
            dodgeTimer: 0,
            dead: false,
            headX: 0,
            headY: 0
        };

        // Enemy
        const enemy = {
            x: 900,
            y: 500,
            width: 30,
            height: 80,
            swordAngle: Math.PI,
            swordLength: 80,
            attacking: false,
            attackTimer: 0,
            dodging: false,
            dodgeTimer: 0,
            dead: false,
            headX: 0,
            headY: 0,
            aiTimer: 0,
            aiState: 'idle'
        };

        // Blood particles
        const blood = [];

        // Mouse tracking
        let mouseX = canvas.width / 2;
        let mouseY = canvas.height / 2;

        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = (e.clientX - rect.left) * (canvas.width / rect.width);
            mouseY = (e.clientY - rect.top) * (canvas.height / rect.height);
        });

        canvas.addEventListener('click', () => {
            if (gameStarted && !player.dead && !player.attacking) {
                player.attacking = true;
                player.attackTimer = 15;
            }
        });

        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            if (gameStarted && !player.dead && !player.dodging) {
                player.dodging = true;
                player.dodgeTimer = 20;
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameStarted && !player.dead) {
                e.preventDefault();
                // Shove enemy
                if (Math.abs(player.x - enemy.x) < 150 && !enemy.dodging) {
                    enemy.x += 50;
                    enemy.aiTimer = 30;
                }
            }
        });

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            gameStarted = true;
            ui.innerHTML = 'Kills: 0';
            resetEnemy();
        }

        function resetEnemy() {
            enemy.x = 900;
            enemy.y = 500;
            enemy.dead = false;
            enemy.attacking = false;
            enemy.dodging = false;
            enemy.swordAngle = Math.PI;
            enemy.aiTimer = Math.random() * 60 + 30;
            enemy.aiState = 'approach';
        }

        function createBlood(x, y, count) {
            for (let i = 0; i < count; i++) {
                blood.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 12,
                    vy: Math.random() * -10 - 5,
                    size: Math.random() * 6 + 3,
                    life: 1.0
                });
            }
        }

        function updateAI() {
            if (enemy.dead) return;

            enemy.aiTimer--;

            if (enemy.aiTimer <= 0) {
                // Make decision
                const dist = enemy.x - player.x;

                if (dist > 200) {
                    // Approach
                    enemy.x -= 3;
                    enemy.aiState = 'approach';
                    enemy.aiTimer = 20;
                } else if (dist < 100 && Math.random() < 0.3) {
                    // Back off
                    enemy.x += 2;
                    enemy.aiTimer = 20;
                } else if (dist < 150 && Math.random() < 0.4) {
                    // Attack!
                    if (!enemy.attacking) {
                        enemy.attacking = true;
                        enemy.attackTimer = 15;
                    }
                    enemy.aiTimer = 40;
                } else if (player.attacking && Math.random() < 0.6) {
                    // Dodge player attack
                    enemy.dodging = true;
                    enemy.dodgeTimer = 20;
                    enemy.aiTimer = 40;
                } else {
                    enemy.aiTimer = 10;
                }
            }

            // Aim sword at player
            const dx = player.x - enemy.x;
            const dy = player.y - enemy.y;
            enemy.swordAngle = Math.atan2(dy, dx);
        }

        function checkCollisions() {
            // Player sword vs enemy
            if (player.attacking && player.attackTimer > 10 && !enemy.dead && !enemy.dodging) {
                const playerSwordX = player.x + Math.cos(player.swordAngle) * player.swordLength;
                const playerSwordY = player.y + Math.sin(player.swordAngle) * player.swordLength;

                const dist = Math.sqrt(
                    Math.pow(playerSwordX - enemy.x, 2) + 
                    Math.pow(playerSwordY - enemy.y, 2)
                );

                if (dist < 60) {
                    // Check if enemy is blocking
                    const angleDiff = Math.abs(player.swordAngle - enemy.swordAngle);
                    if (angleDiff > 0.8) { // Not blocking
                        enemy.dead = true;
                        enemy.headX = enemy.x;
                        enemy.headY = enemy.y - 40;
                        createBlood(enemy.x, enemy.y - 20, 40);
                        kills++;
                        ui.innerHTML = 'Kills: ' + kills;
                        setTimeout(resetEnemy, 2000);
                    }
                }
            }

            // Enemy sword vs player
            if (enemy.attacking && enemy.attackTimer > 10 && !player.dead && !player.dodging) {
                const enemySwordX = enemy.x + Math.cos(enemy.swordAngle) * enemy.swordLength;
                const enemySwordY = enemy.y + Math.sin(enemy.swordAngle) * enemy.swordLength;

                const dist = Math.sqrt(
                    Math.pow(enemySwordX - player.x, 2) + 
                    Math.pow(enemySwordY - player.y, 2)
                );

                if (dist < 60) {
                    const angleDiff = Math.abs(player.swordAngle - enemy.swordAngle);
                    if (angleDiff > 0.8) {
                        player.dead = true;
                        player.headX = player.x;
                        player.headY = player.y - 40;
                        createBlood(player.x, player.y - 20, 40);
                        gameOver = true;
                        setTimeout(() => {
                            alert('DEFEATED! Kills: ' + kills);
                            location.reload();
                        }, 1500);
                    }
                }
            }
        }

        function update() {
            if (!gameStarted) return;

            // Update player sword angle to mouse
            if (!player.dead) {
                const dx = mouseX - player.x;
                const dy = mouseY - player.y;
                player.swordAngle = Math.atan2(dy, dx);
            }

            // Update timers
            if (player.attackTimer > 0) {
                player.attackTimer--;
                if (player.attackTimer === 0) player.attacking = false;
            }

            if (player.dodgeTimer > 0) {
                player.dodgeTimer--;
                if (player.dodgeTimer === 0) player.dodging = false;
            }

            if (enemy.attackTimer > 0) {
                enemy.attackTimer--;
                if (enemy.attackTimer === 0) enemy.attacking = false;
            }

            if (enemy.dodgeTimer > 0) {
                enemy.dodgeTimer--;
                if (enemy.dodgeTimer === 0) enemy.dodging = false;
            }

            // Update AI
            updateAI();

            // Check collisions
            checkCollisions();

            // Update blood
            for (let i = blood.length - 1; i >= 0; i--) {
                const b = blood[i];
                b.vy += 0.5; // gravity
                b.x += b.vx;
                b.y += b.vy;
                b.life -= 0.01;
                if (b.life <= 0 || b.y > canvas.height) {
                    blood.splice(i, 1);
                }
            }
        }

        function drawCharacter(char, isPlayer) {
            if (char.dead) {
                // Draw headless body
                ctx.fillStyle = '#4a0000';
                ctx.fillRect(char.x - char.width / 2, char.y - char.height / 2 + 20, char.width, char.height - 20);

                // Draw severed head
                ctx.fillStyle = '#d4a574';
                ctx.fillRect(char.headX - 12, char.headY - 12, 24, 24);

                // Blood splatter on body
                ctx.fillStyle = '#8b0000';
                ctx.fillRect(char.x - char.width / 2, char.y - char.height / 2 + 15, char.width, 10);
                return;
            }

            // Body
            ctx.fillStyle = char.dodging ? '#555' : '#1a1a1a';
            ctx.fillRect(char.x - char.width / 2, char.y - char.height / 2, char.width, char.height);

            // Head
            ctx.fillStyle = '#d4a574';
            ctx.fillRect(char.x - 12, char.y - char.height / 2 - 20, 24, 20);

            // Sword
            ctx.save();
            ctx.translate(char.x, char.y);
            ctx.rotate(char.swordAngle);

            // Blade
            ctx.strokeStyle = char.attacking ? '#ffffff' : '#c0c0c0';
            ctx.lineWidth = char.attacking ? 6 : 4;
            ctx.beginPath();
            ctx.moveTo(0, 0);
            ctx.lineTo(char.swordLength, 0);
            ctx.stroke();

            // Handle
            ctx.strokeStyle = '#8b0000';
            ctx.lineWidth = 8;
            ctx.beginPath();
            ctx.moveTo(-10, 0);
            ctx.lineTo(10, 0);
            ctx.stroke();

            ctx.restore();
        }

        function draw() {
            // Background
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#4a1a1a');
            gradient.addColorStop(1, '#2a0808');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Ground
            ctx.fillStyle = '#3a2a1a';
            ctx.fillRect(0, canvas.height - 150, canvas.width, 150);
            ctx.strokeStyle = '#8b0000';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, canvas.height - 150);
            ctx.lineTo(canvas.width, canvas.height - 150);
            ctx.stroke();

            // Blood
            for (const b of blood) {
                ctx.globalAlpha = b.life;
                ctx.fillStyle = '#8b0000';
                ctx.beginPath();
                ctx.arc(b.x, b.y, b.size, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;

            // Characters
            drawCharacter(player, true);
            drawCharacter(enemy, false);
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        gameLoop();
    </script>
</body>
</html>